@model List<Habit>
<head>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>



<body>
    <h2 class="py-2">Habit View</h2>
    <a asp-controller="Habit" asp-action="Create" class="btn btn-primary m-2">
        Create New Habit
    </a>

    <table class="table table-bordered container-lg" style="text-align: center">
        <thead>
            <tr>
                <th style="width:20%">Habit Name</th>
                <th style="width:8%">Monday</th>
                <th style="width:8%">Tuesday</th>
                <th style="width:8%">Wednesday</th>
                <th style="width:8%">Thursday</th>
                <th style="width:8%">Friday</th>
                <th style="width:8%">Saturday</th>
                <th style="width:8%">Sunday</th>
                <th style="width:6%">Your goal</th>
                <th style="width:8%">Edit</th>
            </tr>
        </thead>
        <tbody>

            @foreach (var habit in Model)
            {
                <tr>
                    <td>@habit.Name</td>

                    @foreach (var obj in habit.habitRealizations)
                    {
                        <td id="@obj.Id" onclick="updateIfExecutedStatus(@obj.Id, @obj.IfExecuted)" )>

                            <span id="icon-@obj.Id" style="color:#3CB371;">

                                @if (obj.IfExecuted == 1)
                                {
                                    <i class="bi bi-check-square-fill" style="color:#3CB371;"></i>
                                }

                            </span>

                            <input type="hidden" id="obj.Id" value="@obj.Id" />

                        </td>

                    }

                    <td>@habit.QuantityPerWeek</td>
                    <td>

                        <a asp-controller="Habit" asp-action="Edit" asp-route-id="@habit.Id" class="btn btn-outline-primary">
                            Edit
                        </a>

                    </td>
                </tr>
            }


        </tbody>
    </table>
    <a asp-controller="Habit" asp-action="" class="btn btn-primary">
        Next week has come?
    </a>

</body>



<script>
    function updateIfExecutedStatus(itemId, ifExecuted) {

        
        $.ajax({
            type: "GET",
            url: '@Url.Action("UpdateIfExecuted", "HabitRealization")',
            data: { id: itemId },
            success: function (result) {
                // Jeśli operacja się powiodła, możesz wykonać dodatkowe akcje
                console.log("IfExecuted updated successfully");

                if (result.ifExecuted === 1) {
                    $("#icon-" + itemId).html('<i class="bi bi-check-square-fill"></i>');
                } else {
                    $("#icon-" + itemId).html('');
                }
            },
            error: function (xhr, status, error) {
                console.error("Error updating IfExecuted:", error);
            }
        });

    }
</script>